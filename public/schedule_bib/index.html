
<!DOCTYPE html><html lang="en"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1">
<title></title>
<link rel="icon" href="/images/icon.png">
<style>
   
  :root {
     
    --color-primary: #2563eb;
    --color-primary-hover: #1d4ed8;
    --color-secondary: #7c3aed;
    --color-accent: #f97316;
    --color-accent-hover: #ea580c;
    --color-success: #10b981;

     
    --color-header-bg: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
    --color-bg: #ffffff;
    --color-text: #1f2937;
    --color-text-secondary: #6b7280;
    --color-border: #e5e7eb;
    --color-code-bg: #f3f4f6;
    --color-hover-bg: #f9fafb;

     
    --font-base: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    --font-mono: "Menlo", "Monaco", "Courier New", monospace;
    --font-size-base: 0.95rem;
    --font-size-small: 0.85rem;
    --line-height-base: 1.6;
    --line-height-heading: 1.3;

     
    --space-xs: 0.5rem;
    --space-sm: 0.75rem;
    --space-md: 1rem;
    --space-lg: 1.5rem;
    --space-xl: 1.75rem;
    --space-2xl: 2.5rem;

     
    --max-width: 960px;
    --border-radius: 8px;
    --border-radius-sm: 6px;

     
    --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.1);
    --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.1);
    --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.12);
    --shadow-glow: 0 0 20px rgba(249, 115, 22, 0.3);

     
    --transition-fast: 150ms ease;
    --transition-base: 200ms ease;
    --transition-slow: 300ms ease;
  }

   
  *, *::before, *::after {
    box-sizing: border-box;
  }

  html {
    font-size: 16px;
    scroll-behavior: smooth;
  }

  html, body {
    margin: 0;
    padding: 0;
    font-family: var(--font-base);
    color: var(--color-text);
    background: var(--color-bg);
    line-height: var(--line-height-base);
    font-size: var(--font-size-base);
  }

   
  h1, h2, h3, h4, h5, h6 {
    line-height: var(--line-height-heading);
    color: var(--color-text);
    font-weight: 600;
    letter-spacing: -0.02em;
    margin-top: var(--space-xl);
    margin-bottom: var(--space-md);
  }

  h1 {
    font-size: clamp(1.5rem, 3.5vw, 1.9rem);
    margin-top: var(--space-2xl);
  }

  h2 {
    font-size: clamp(1.25rem, 2.5vw, 1.5rem);
  }

  h3 {
    font-size: clamp(1.1rem, 2vw, 1.25rem);
  }

  h4, h5, h6 {
    font-size: 1rem;
  }

  p {
    margin-top: 0;
    margin-bottom: var(--space-md);
  }

   
  a {
    color: var(--color-primary);
    text-decoration: none;
    transition: all var(--transition-fast);
    position: relative;
  }

  a:hover {
    color: var(--color-accent);
    text-decoration: none;
  }

  main a:not(.cite-pop):hover {
    text-decoration: underline;
    text-decoration-color: var(--color-accent);
    text-decoration-thickness: 2px;
    text-underline-offset: 3px;
  }

  a:focus {
    outline: 2px solid var(--color-accent);
    outline-offset: 2px;
    border-radius: 2px;
  }

   
  img {
    max-width: 100%;
    height: auto;
    border-radius: var(--border-radius-sm);
    display: block;
  }

   
  code {
    font-family: var(--font-mono);
    font-size: 0.9em;
    background: var(--color-code-bg);
    padding: 0.125rem 0.375rem;
    border-radius: 4px;
  }

  pre {
    background: var(--color-code-bg);
    border-radius: var(--border-radius-sm);
    padding: var(--space-md);
    overflow-x: auto;
    line-height: 1.5;
  }

  pre code {
    background: transparent;
    padding: 0;
    white-space: pre-wrap;
  }

   
  .wrap {
    max-width: var(--max-width);
    margin: 0 auto;
    padding: clamp(1rem, 3vw, 1.5rem);
  }

  main.wrap {
    padding: clamp(1rem, 3vw, 1.5rem);
  }

   
  header {
    background: var(--color-header-bg);
    color: #fff;
    padding: 1.25rem var(--space-lg);
    box-shadow: var(--shadow-md);
    position: sticky;
    top: 0;
    z-index: 100;
    border-bottom: 2px solid rgba(249, 115, 22, 0.3);
  }

  header .wrap {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--space-md);
    padding: 0;
    min-height: 32px;
  }

  header strong {
    font-size: 1.05rem;
    font-weight: 600;
    letter-spacing: -0.01em;
    color: #fff;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
    line-height: 1.4;
    display: flex;
    align-items: center;
  }

  header a {
    color: rgba(255, 255, 255, 0.9);
    text-decoration: none;
    padding: var(--space-xs) var(--space-sm);
    border-radius: var(--border-radius-sm);
    transition: all var(--transition-fast);
    font-size: 0.95rem;
  }

  header a:hover {
    color: var(--color-accent);
    background: rgba(249, 115, 22, 0.1);
    text-decoration: none;
    transform: translateY(-1px);
  }

   
  nav ul {
    list-style: none;
    padding: 0;
    margin: 0;
    display: flex;
    gap: var(--space-xs);
    align-items: center;
  }

  nav li {
    margin: 0;
    list-style: none;
  }

   
  .nav-toggle {
    display: none;
    align-items: center;
    justify-content: center;
    flex-direction: column;
    gap: 4px;
    width: 44px;
    height: 44px;
    border: 1px solid rgba(249, 115, 22, 0.3);
    border-radius: var(--border-radius-sm);
    background: rgba(249, 115, 22, 0.05);
    color: #fff;
    cursor: pointer;
    transition: all var(--transition-fast);
    padding: 0;
  }

  .nav-toggle:hover {
    background: rgba(249, 115, 22, 0.15);
    border-color: var(--color-accent);
    transform: scale(1.05);
  }

  .nav-toggle span {
    display: block;
    width: 20px;
    height: 2px;
    background: var(--color-accent);
    transition: all var(--transition-fast);
  }

   
  footer {
    border-top: 1px solid var(--color-border);
    color: var(--color-text-secondary);
    padding: var(--space-lg) var(--space-lg);
    font-size: var(--font-size-small);
    margin-top: var(--space-2xl);
  }

   
  .subtitle {
    color: var(--color-text-secondary);
    font-size: 1rem;
    margin-top: calc(-1 * var(--space-md));
    margin-bottom: var(--space-xl);
    font-style: italic;
  }

  .postlist {
    list-style: none;
    padding: 0;
  }

  .postlist li {
    margin: var(--space-md) 0;
    padding: var(--space-md);
    border-radius: var(--border-radius-sm);
    transition: all var(--transition-fast);
    border-left: 3px solid transparent;
  }

  .postlist li:hover {
    background: var(--color-hover-bg);
    border-left-color: var(--color-accent);
    transform: translateX(4px);
    box-shadow: var(--shadow-sm);
  }

   
  .hero {
    position: relative;
    left: 50%;
    right: 50%;
    margin-left: -50vw;
    margin-right: -50vw;
    width: 100vw;
    margin-top: -23px;
    margin-bottom: 0;
    padding-top: 0;
    line-height: 0;
    max-height: 400px;
    overflow: hidden;
  }

  .hero img {
    display: block;
    width: 100%;
    height: 400px;
    object-fit: cover;
    border-radius: 0;
    opacity: 0.75;
    filter: brightness(0.85);
  }

   
  main.wrap > .hero:first-child ~ * {
    position: relative;
    z-index: 2;
    background: rgba(255, 255, 255, 0.92);
    backdrop-filter: blur(10px);
    padding: var(--space-xl);
    border-radius: var(--border-radius);
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);
    max-width: 750px;
    margin-left: auto;
    margin-right: auto;
    border: 1px solid rgba(255, 255, 255, 0.3);
  }

  main.wrap > .hero:first-child + h1 {
    margin-top: calc(-350px);
    margin-bottom: var(--space-lg);
  }

  main.wrap > .hero:first-child ~ h1 + * {
    margin-top: var(--space-lg);
  }

  main.wrap > .hero:first-child ~ h1 ~ * {
    margin-top: var(--space-lg);
  }

   
  main.wrap:has(.hero) {
    padding-bottom: var(--space-2xl) !important;
  }

   
  .cite-pop {
    border: 0;
    background: transparent;
    text-decoration: underline;
    text-decoration-color: var(--color-primary);
    text-decoration-thickness: 1px;
    text-underline-offset: 2px;
    cursor: pointer;
    padding: 0;
    color: var(--color-primary);
    font-size: inherit;
    font-family: inherit;
    transition: all var(--transition-fast);
  }

  .cite-pop:hover {
    color: var(--color-accent);
    text-decoration-color: var(--color-accent);
    text-decoration-thickness: 2px;
  }

  .cite-pop:focus {
    outline: 2px solid var(--color-accent);
    outline-offset: 2px;
    border-radius: 2px;
  }

  .cite-popover {
    font-size: inherit;
    position: absolute;
    max-width: 540px;
    background: var(--color-bg);
    border: 1px solid var(--color-border);
    box-shadow: var(--shadow-lg);
    border-radius: var(--border-radius);
    padding: var(--space-md) var(--space-lg) var(--space-md) var(--space-md);
    z-index: 1000;
    animation: fadeIn var(--transition-base);
  }

  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: translateY(-4px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .cite-popover p {
    margin: 0;
    line-height: 1.5;
  }

  .cite-popover a {
    word-break: break-all;
  }

  .cite-popover .cite-body {
    padding-right: var(--space-xl);
  }

  .cite-popover .cite-close {
    position: absolute;
    top: var(--space-sm);
    right: var(--space-sm);
    border: 0;
    background: transparent;
    font-size: 1.25rem;
    line-height: 1;
    cursor: pointer;
    color: var(--color-text-secondary);
    width: 28px;
    height: 28px;
    border-radius: var(--border-radius-sm);
    transition: all var(--transition-fast);
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .cite-popover .cite-close:hover {
    background: var(--color-hover-bg);
    color: var(--color-text);
  }

  .cite-popover .cite-copy {
    background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-hover) 100%);
    border: none;
    border-radius: var(--border-radius-sm);
    padding: var(--space-xs) var(--space-md);
    cursor: pointer;
    font-size: var(--font-size-small);
    font-family: var(--font-base);
    color: #fff;
    font-weight: 500;
    transition: all var(--transition-fast);
  }

  .cite-popover .cite-copy:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(249, 115, 22, 0.4);
  }

   
  table {
    width: 100%;
    border-collapse: collapse;
    margin: var(--space-lg) 0;
    font-size: 0.9rem;
  }

  th, td {
    padding: var(--space-sm) var(--space-md);
    text-align: left;
    border-bottom: 1px solid var(--color-border);
  }

  th {
    background: var(--color-code-bg);
    font-weight: 600;
    color: var(--color-text);
    font-size: 0.85rem;
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }

  tr:hover {
    background: var(--color-hover-bg);
  }

  tbody tr {
    transition: background var(--transition-fast);
  }

   
  @media (max-width: 768px) {
    :root {
      --space-xl: 1.5rem;
      --space-2xl: 2rem;
    }

    .wrap {
      padding: var(--space-md);
    }

    header {
      padding: var(--space-md);
    }

    header nav ul {
      display: block;
      overflow: hidden;
      max-height: 0;
      transition: max-height 0.3s ease;
      flex-direction: column;
      align-items: flex-start;
      gap: var(--space-xs);
      margin-top: var(--space-md);
    }

    header.nav-open nav ul {
      max-height: 500px;
    }

    header nav li a {
      display: block;
      padding: var(--space-sm) var(--space-md);
    }

    .nav-toggle {
      display: inline-flex;
    }

    .cite-popover {
      left: 16px !important;
      right: 16px;
      max-width: calc(100vw - 32px);
    }

    h1 {
      margin-top: var(--space-xl);
    }

     
    .hero {
      max-height: 300px;
    }

    .hero img {
      height: 300px;
    }

    main.wrap > .hero:first-child + h1 {
      margin-top: calc(-260px);
      font-size: 1.35rem;
    }

    main.wrap > .hero:first-child ~ * {
      padding: var(--space-md);
      max-width: 90%;
    }
  }

  @media (max-width: 480px) {
    header strong {
      font-size: 0.95rem;
    }

    .nav-toggle span {
      width: 18px;
    }

    table {
      font-size: 0.8rem;
    }

    th, td {
      padding: var(--space-xs) var(--space-sm);
    }
  }

   
  header, header .wrap, header nav, header nav ul {
    margin-bottom: 0 !important;
  }

  main.wrap {
    padding-top: 0 !important;
  }

  main.wrap > .hero:first-child {
    margin-top: 0 !important;
  }

  main.wrap > *:first-child:not(.hero) {
    margin-top: 0 !important;
    padding-top: var(--space-lg);
  }

   
  main.wrap:not(:has(.hero)) {
    padding: clamp(1rem, 3vw, 1.5rem) !important;
  }
</style></head><body>
<header><div class="wrap">
  <strong>Psych 711: Cognitive Science of Large Language Models. Fall, 2025</strong>
  
<button class="nav-toggle" aria-controls="site-nav" aria-label="Open menu" aria-expanded="false"><span></span><span></span><span></span></button>
<nav id="site-nav" style="float:right;"><ul>
    <li><a href="/">Home</a></li><li><a href="/schedule/">Schedule</a></li><li><a href="/logistics/">Logistics</a></li><li><a href="/resources/">Resources</a></li>
  </ul></nav><div style="clear:both;"></div>
</div></header>
<main class="wrap">
<article>
  <h1></h1>
  
  <div class="content"><h1 id="class-schedule">Class Schedule<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup></h1>
<p>I recommend reading the papers in the order in which they are listed.</p>
<h1 id="r-advdatewed-1"><code>r advdate(wed, 1)</code></h1>
<h3 id="what-is-learnable">What is learnable?</h3>
<ul>
<li><strong>Readings (in class):</strong> @suttonBitterLesson2019; @WhatIntelligenceAntikythera;</li>
<li><em>Related resources</em>: @halevyUnreasonableEffectivenessData2009; <a href="https://youtube.com/watch?v=R7qy2BY6mTk&amp;list=PL2xTeGtUb-8B94jdWGT-chu4ucI7oEe_x&amp;index=32&amp;pp=iAQB">talk by Alyosha Efros</a></li>
</ul>
<h1 id="r-advdatewed-2"><code>r advdate(wed, 2)</code></h1>
<h3 id="how-do-llms-work">How do LLMs work?</h3>
<ul>
<li><strong>Readings:</strong> @rumelhartArchitectureMindConnectionist1989; @leeLargeLanguageModels2025; Either @vaswaniAttentionAllYou2023 or @phuongFormalAlgorithmsTransformers2022.</li>
<li><strong>Other resources for understanding transformers (very useful; strongly recommended!)</strong>:
<a href="https://jalammar.github.io/illustrated-transformer/?utm_source=chatgpt.com">The illustrated transformer</a>; <a href="https://www.youtube.com/watch?v=wjZofJX0v4M&amp;ab_channel=3Blue1Brown">Transformers, the tech behind LLMs video</a> and the <a href="https://www.youtube.com/watch?v=eMlx5fFNoYc&amp;ab_channel=3Blue1Brown">next chapter focusing on attention</a>;</li>
<li>Extra: @mccoyEmbersAutoregressionShow2024</li>
</ul>
<h1 id="r-advdatewed-3"><code>r advdate(wed, 3)</code></h1>
<h3 id="learning-language-from-language">Learning language from language</h3>
<p><strong>Special guest</strong> - Steven Piantadosi</p>
<ul>
<li><strong>Readings:</strong> @elman_finding_1990; @boleda_distributional_2020; @piantadosiModernLanguageModels2024</li>
</ul>
<h1 id="r-advdatewed-4"><code>r advdate(wed, 4)</code></h1>
<h3 id="learning-about-the-world-from-language">Learning about the world from language</h3>
<p><strong>Special guest</strong> - Marina Bedny</p>
<ul>
<li>
<p><strong>Readings:</strong> <a href="https://scholar.harvard.edu/files/seyer/files/plato_republic_514b-518d_allegory-of-the-cave.pdf">Plato: The allegory of the cave</a>; @lupyan_words-as-mappings_2017; @yildirimTaskStructuresWorld2024; @wangConstructingMeaningLanguageforthcoming</p>
</li>
<li>
<p>Recommended: response to Yildirim and Paul: @godduLLMsDontKnow2024; Counter-response: @yildirimResponseGodduNew2024</p>
</li>
</ul>
<h1 id="r-advdatewed-5"><code>r advdate(wed, 5)</code></h1>
<h3 id="do-large-language-models-understand-us">Do large language models understand us?</h3>
<ul>
<li><strong>Readings:</strong> @mitchell_debate_2023; @aguerayarcasLargeLanguageModels2022; @piantadosi_meaning_2022</li>
<li><strong>Short reflection essay</strong>: So what do you think? Do large language models understand us? (~800 words).</li>
<li>Extra: Feel free to also browse the talks in <a href="https://skywritingspress.ca/">this series organized by Stevan Harnad</a>, e.g., the <a href="https://www.youtube.com/watch?v=yyRzTL201zI&amp;list=PL2xTeGtUb-8B94jdWGT-chu4ucI7oEe_x&amp;index=24&amp;pp=iAQB">different kinds of understanding by Chalmers</a>.</li>
</ul>
<h1 id="r-advdatewed-6"><code>r advdate(wed, 6)</code></h1>
<h3 id="stress-testing-embodiment">Stress testing embodiment</h3>
<ul>
<li>Lots of reading this week!</li>
<li><strong>Readings:</strong> @barsalou_perceptual_1999; @mollo_vector_2023; @pavlickSymbolsGroundingLarge2023</li>
<li>Extra: <a href="https://philpapers.org/archive/CHADTR.pdf">A philosophical take by David Chalmers on the possibility of &ldquo;pure thinkers&rdquo;</a></li>
</ul>
<h1 id="r-advdatewed-7"><code>r advdate(wed, 7)</code></h1>
<h3 id="stress-testing-the-language-of-thought-hypothesis-learning-to-learn-and-represent">Stress testing the language of thought hypothesis: learning to learn and represent</h3>
<ul>
<li><strong>Readings:</strong> @quilty-dunn_best_2022 (also read at least 2 positive and 2 negative commentaries); @lakeHumanlikeSystematicGeneralization2023; Watch <a href="https://www.youtube.com/watch?v=6gSYMX3I5Bs&amp;ab_channel=KempnerInstituteatHarvardUniversity">this talk on learning compositionality by Pavlick</a></li>
<li>Extra: @griffithsWhitherSymbolsEra2025; @binzMetalearnedModelsCognition2024;</li>
</ul>
<h1 id="r-advdatewed-8"><code>r advdate(wed, 8)</code></h1>
<h3 id="stress-testing-numerical-cognition">Stress testing numerical cognition</h3>
<ul>
<li><strong>Readings:</strong> @leslie2008generative; @banerjeeChildrensArithmeticSkills2025; @oshaughnessyDiverseMathematicalKnowledge2023; @nandaProgressMeasuresGrokking2023 (don&rsquo;t worry about all the technical details. Focus on the big picture. The authors do have a useful <a href="https://www.youtube.com/watch?v=IHikLL8ULa4&amp;ab_channel=NeelNanda">video walkthrough</a>).</li>
<li>Extra: @gordon_numerical_2004; @oshaughnessy2019cultural;</li>
</ul>
<h1 id="r-advdatewed-9"><code>r advdate(wed, 9)</code></h1>
<h3 id="stress-testing-reasoning-the-role-of-context">Stress testing reasoning: the role of context</h3>
<ul>
<li><strong>Readings:</strong> @evans_dual-processing_2008; @lampinenLanguageModelsHumans2024</li>
</ul>
<h1 id="r-advdatewed-10"><code>r advdate(wed, 10)</code></h1>
<ul>
<li><strong>No Readings for this week</strong> Work on project pitches. Post preliminary ideas on Canvas. Individual meetings to discuss the ideas w/ Gary during class.</li>
</ul>
<h1 id="r-advdatewed-11"><code>r advdate(wed, 11)</code></h1>
<h3 id="stress-testing-methodology-of-cognitive-psychologycognitive-neuroscience">Stress testing methodology of cognitive psychology/cognitive (neuro)science</h3>
<ul>
<li><strong>Readings:</strong>
@bowerExperimentalMethodsCognitive1989 (read or skim depending on your level of familiarity); @jonasCouldNeuroscientistUnderstand2017; Read 2 of the 12 case studies from @lindsey+BiologyLargeLanguage</li>
<li>Extras: @nickelsSingleCaseStudies2022; @yarkoniGeneralizabilityCrisis2020</li>
</ul>
<h1 id="r-advdatewed-12"><code>r advdate(wed, 12)</code></h1>
<h3 id="stress-testing-theories-of-intelligence">Stress testing theories of intelligence</h3>
<p><strong>Special guest</strong> - Blaise Aguera y Arcas</p>
<ul>
<li><strong>Readings:</strong> <em>(Tentative)</em> @leggCollectionDefinitionsIntelligence2007; @cholletMeasureIntelligence2019; @arcasWhatIntelligenceLessons2025 (Chapter 12 in the PDF or the updated mildly interactive version <a href="https://whatisintelligence.antikythera.org/chapter-10/#periodization">online</a>).</li>
<li>Extras: @szathmary_major_1995; @van_der_maas_dynamical_2006</li>
</ul>
<h1 id="r-advdatewed-13"><code>r advdate(wed, 13)</code></h1>
<h3 id="thanksgiving---no-class">Thanksgiving - no class</h3>
<ul>
<li><strong>Project proposals due</strong> by 8pm.</li>
</ul>
<h1 id="r-advdatewed-14"><code>r advdate(wed, 14)</code></h1>
<h3 id="revisiting-old-and-new-questions">Revisiting old and new questions</h3>
<ul>
<li><strong>Readings:</strong> Review previous readings in light of what you&rsquo;ve learned</li>
<li><strong>Short reflection essay</strong>: Is all the AI madness of the last few years good for or bad for understanding the human mind? (~800 words).</li>
</ul>
<h1 id="r-advdatewed-15"><code>r advdate(wed, 15)</code></h1>
<h3 id="final-presentations">Final presentations</h3>
<h3 id="group-project-presentations-20-min-presentation--8-min-qa">Group project presentations [20 min presentation + 8 min Q&amp;A].</h3>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p>Subject to revision&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>
</div>
</article>
</main>
<footer><div class="wrap">© 2026 Gary Lupyan</div></footer>


<script>

(function(){
  let pop=null, hoverTimer=null;
  function close(){ if(pop){ pop.remove(); pop=null; } }
  function copyPlain(text){
    try {
      navigator.clipboard.writeText(text);
    } catch(e){
      
      const t=document.createElement('textarea');
      t.value=text; document.body.appendChild(t);
      t.select(); document.execCommand('copy'); t.remove();
    }
  }
  function open(el, html, plain){
    close();
    pop=document.createElement('div');
    pop.className='cite-popover';
    pop.innerHTML='<button class="cite-close" aria-label="Close">×</button>' +
                  '<div class="cite-body">'+html+'</div>' +
                  '<div style="margin-top:8px;text-align:right;"><button class="cite-copy" type="button">Copy reference</button></div>';
    document.body.appendChild(pop);
    const r=el.getBoundingClientRect();
    const top=window.scrollY + r.bottom + 8;
    let left=window.scrollX + r.left;
    requestAnimationFrame(()=>{
      if(left+pop.offsetWidth > window.scrollX + window.innerWidth - 16){
        left = Math.max(16, window.scrollX + window.innerWidth - pop.offsetWidth - 16);
      }
      pop.style.top=top+'px'; pop.style.left=left+'px';
    });
    pop.querySelector('.cite-close').addEventListener('click', close);
    pop.querySelector('.cite-copy').addEventListener('click', function(){ copyPlain(plain); });
  }
  document.addEventListener('click', function(e){
    const a=e.target.closest('.cite-pop');
    if(a){
      e.preventDefault();
      open(a, a.getAttribute('data-ref'), a.getAttribute('data-plain'));
      return;
    }
    if(pop && !e.target.closest('.cite-popover')) close();
  });
  
  document.addEventListener('mouseover', function(e){
    const a=e.target.closest('.cite-pop');
    if(!a) return;
    clearTimeout(hoverTimer);
    hoverTimer=setTimeout(()=>{ open(a, a.getAttribute('data-ref'), a.getAttribute('data-plain')); }, 120);
  });
  document.addEventListener('mouseout', function(e){
    if(!pop) return;
    if(e.relatedTarget && (e.relatedTarget.closest('.cite-popover') || e.relatedTarget.closest('.cite-pop'))) return;
    clearTimeout(hoverTimer);
    hoverTimer=setTimeout(close, 200);
  });
  document.addEventListener('keydown', function(e){ if(e.key==='Escape') close(); });
  document.addEventListener('mouseover', function(e){
    if(pop && e.target.closest('.cite-popover')){ clearTimeout(hoverTimer); }
  });
  document.addEventListener('mouseout', function(e){
    if(pop && e.target.closest('.cite-popover')){
      clearTimeout(hoverTimer);
      hoverTimer=setTimeout(close, 200);
    }
  });
})();
</script>

<script>

(function(){
  const header = document.querySelector('header');
  const btn = document.querySelector('.nav-toggle');
  if(!header || !btn) return;
  btn.addEventListener('click', function(){
    const open = header.classList.toggle('nav-open');
    btn.setAttribute('aria-expanded', open ? 'true' : 'false');
  });
  
  header.addEventListener('click', function(e){
    const a = e.target.closest('nav a');
    if(a && header.classList.contains('nav-open')){
      header.classList.remove('nav-open');
      btn.setAttribute('aria-expanded','false');
    }
  });
  
  document.addEventListener('click', function(e){
    if(header.classList.contains('nav-open') && !e.target.closest('header')){
      header.classList.remove('nav-open');
      btn.setAttribute('aria-expanded','false');
    }
  });
  
  document.addEventListener('keydown', function(e){
    if(e.key === 'Escape' && header.classList.contains('nav-open')){
      header.classList.remove('nav-open');
      btn.setAttribute('aria-expanded','false');
    }
  });
})();
</script>
</body></html>



